apiVersion: v1
kind: Namespace
metadata:
  name: sample-ko-monorepo
  labels:
    policy.sigstore.dev/include: "true"

---
apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: webthingy
  namespace: sample-ko-monorepo
spec:
  template:
    spec:
      containers:
        - image: ghcr.io/bobymcbobs/sample-ko-monorepo/webthingy@sha256:4d5bb45089f0a73dd9dbd7ef3b48090fb51a76cd952f14b641d6e29cb8852638
          securityContext:
            runAsUser: 1000
            runAsGroup: 1000
            readOnlyRootFilesystem: true
          ports:
            - containerPort: 8080

---
apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: mission-critical-service
  namespace: sample-ko-monorepo
spec:
  template:
    spec:
      containers:
        - image: ghcr.io/bobymcbobs/sample-ko-monorepo/mission-critical-service@sha256:7ae9f9cdd4d3bf683dfc4c5270b4f5a3955eedb868d9b04f072c1fd842cd8670
          securityContext:
            runAsUser: 1000
            runAsGroup: 1000
            readOnlyRootFilesystem: true
          ports:
            - containerPort: 8080

---
apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: coolest-serverless-app
  namespace: sample-ko-monorepo
spec:
  template:
    spec:
      containers:
        - image: ghcr.io/bobymcbobs/sample-ko-monorepo/coolest-serverless-app@sha256:40b95a990f7bd5a8a8489f330a0364c65113b78d117801545faf5db456596575
          securityContext:
            runAsUser: 1000
            runAsGroup: 1000
            readOnlyRootFilesystem: true
          ports:
            - containerPort: 8080
          livenessProbe:
            httpGet:
              path: /api/_healthz
              port: 8080
            initialDelaySeconds: 5
            periodSeconds: 5
          readinessProbe:
            httpGet:
              path: /api/_healthz
              port: 8080
            initialDelaySeconds: 5
            periodSeconds: 5

---
